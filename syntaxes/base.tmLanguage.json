{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "B@SE",
    "foldingStartMarker": "\\[%[^/].*%]",
    "foldingStopMarker": "\\[%\/.*%]",
    "patterns": [
        {
            "include": "#htmlCommentsOverride"
        },
        {
            "include": "text.html.basic"
        },
        {
            "include": "#variables"
        },
        {
            "include": "#functions"
        }
    ],
    "repository": {
        "variables": {
            "name": "entity.name.tag.base",
            "begin": "\\[@([^\\s@]+)",
            "end": "@]",
            "beginCaptures": {
                "1": {
                    "name": "support.variable.base"
                }
            },
            "patterns": []
        },
        "quotes": {
            "name": "string.quoted.single.base",
            "begin": "'",
            "end": "'",
            "patterns": [
                {
                    "include": "#variables"
                }
            ]
        },
        "keywords": {
            "name": "keyword.operator.base",
            "begin": "",
            "end": "",
            "match": "(?i) (==|eq|!=|ne|<=|>=|<|>|or|and|like) ",
            "patterns": []
        },
        "functionParams": {
            "name": "variable.parameter.base",
            "begin": ".+?",
            "end": "(?=\/?%])",
            "patterns": [
                {
                    "include": "#quotes"
                },
                {
                    "include": "#variables"
                },
                {
                    "include": "#keywords"
                }
            ]
        },
        "functions": {
            "name": "entity.name.tag.base",
            "begin": "(?i)\\[% ?(\/ ?|end )?((if|elseif|else|while)|(\\w+))((?= )|(?=%)|(?=\/%))",
            "end": "\/?%]",
            "beginCaptures": {
                "3": {
                    "name": "keyword.control.base"
                },
                "4": {
                    "name": "entity.name.function.base"
                }
            },
            "patterns": [
                {
                    "include": "#functionParams"
                }
            ]
        },
        "htmlCommentsOverride": {
			"begin": "<!--",
			"captures": {
				"0": {
					"name": "punctuation.definition.comment.html"
				}
			},
			"end": "--\\s*>",
			"name": "comment.block.html",
			"patterns": [
				{
					"match": "--",
					"name": "invalid.illegal.bad-comments-or-CDATA.html"
				},
				{
					"include": "#embedded-code"
                },
                {
                    "include": "#variables"
                },
                {
                    "include": "#functions"
                }
			]
        }
    },
    "scopeName": "text.html.base"
}